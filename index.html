<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Karaoke Text Animation</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      background: navy;
      overflow: hidden;
      height: 100%;
      font-family: Impact, sans-serif;
    }
    #container {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      text-align: center;
    }
    .word-set {
      font-size: 8vw;
      color: white;
      line-height: 1.2;
      display: flex;
      gap: 1.5vw;
      flex-wrap: wrap;
      justify-content: center;
      position: relative;
    }
    .word {
      position: relative;
      white-space: nowrap;
    }
    .highlight {
      position: absolute;
      top: 0;
      left: 0;
      width: 0%;
      height: 100%;
      color: yellow;
      overflow: hidden;
      white-space: nowrap;
      transition: width 0.4s linear;
    }
  </style>
</head>
<body>
  <div id="container">
    <div id="words" class="word-set"></div>
  </div>

  <script>
    const quote = "For God so loved the world that he gave his one and only Son that whoever believes in him shall not perish but have eternal life";
    const words = quote.split(" ");
    const groupSize = 3;
    const groups = [];

    for (let i = 0; i < words.length; i += groupSize) {
      groups.push(words.slice(i, i + groupSize));
    }

    const wordContainer = document.getElementById('words');

    async function animateText() {
      for (let g = 0; g < groups.length; g++) {
        wordContainer.innerHTML = '';

        groups[g].forEach(word => {
          const span = document.createElement('span');
          span.className = 'word';
          span.innerHTML = `${word}<span class="highlight">${word}</span>`;
          wordContainer.appendChild(span);
        });

        await fadeIn(wordContainer);

        const highlights = wordContainer.querySelectorAll('.highlight');
        for (let i = 0; i < highlights.length; i++) {
          await karaokeFill(highlights[i]);
        }

        await delay(300);
        await fadeOut(wordContainer);
      }

      animateText(); // repeat
    }

    function karaokeFill(el) {
      return new Promise(resolve => {
        el.style.transition = 'none';
        el.style.width = '0%';
        requestAnimationFrame(() => {
          el.style.transition = 'width 1.2s linear';
          el.style.width = '100%';
          setTimeout(resolve, 1200);
        });
      });
    }

    function fadeIn(el) {
      return new Promise(resolve => {
        el.style.opacity = 0;
        el.style.transition = 'opacity 0.5s ease';
        el.style.opacity = 1;
        setTimeout(resolve, 500);
      });
    }

    function fadeOut(el) {
      return new Promise(resolve => {
        el.style.transition = 'opacity 0.5s ease';
        el.style.opacity = 0;
        setTimeout(resolve, 500);
      });
    }

    function delay(ms) {
      return new Promise(res => setTimeout(res, ms));
    }

    animateText();
  </script>
</body>
</html>